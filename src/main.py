Applying the corrections you described results in the following improved code.

### Original Code

